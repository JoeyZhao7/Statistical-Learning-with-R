d0=read.table("P1-4.txt")
names(d0)=c("sales","profit","assets")
d1=d0[,c(1,2)]
pr1=prcomp(d1,center=F,scale=F)
names(pr1)
d1
rot = pr1$rotation
as.matrix(d1)%*%rot
d1x = pr1$x
d1x
var(d1)
var(d1x)
cor(d1x)
pr2=prcomp(d1)
pr2$sdev^2    # [1] 7488.80605   13.83751
d1=d0[,c(1,2)]
d1
pr1=prcomp(d1,center=F,scale=F)
names(pr1)
rot = pr1$rotation
rot
pr2=prcomp(d1)
pr2$sdev^2    # [1] 7488.80605   13.83751
pr1$sdev
pr1$sdev^2
help("prcomp")
pr2$sdev
d2x = pr2$x
var(d2x)
pr1$sdev^2
pr2$rotation
d2x = pr2$x
var(d2x)
apply(d2x,2,var)
help(apply)
apply(d2x,2,mean)
apply(d2x,1,mean)
d2x
apply(d2x,2,var)
pr3=prcomp(d1,scale=T)
d3x = pr3$x
var(d3x)
sum(diag(var(d3x)))   # [1] 2
library(readr)
utilities <- read_csv("C:/Users/Joey Zhao/Desktop/ISE529/utilities.csv")
View(utilities)
d0 = utilities
pr = prcomp(d0,scale=T)
d0 = utilities
d0$X6 = as.numeric(d0$X6)
d1=d0[,-1]
pr = prcomp(d1,scale=T)
pr$rotation
pr$x
rot = pr$rotation
as.matrix(d1)%*%rot
pr$x
as.matrix(saclae(d1))%*%rot
as.matrix(scale(d1))%*%rot
rot
rot$PC1
rot
rot[,1]
d0=read.table("P1-4.txt")
names(d0)=c("sales","profit","assets")
d1=d0[,c(1,2)]
d1
pr1=prcomp(d1,center=F,scale=F)
names(pr1)
pr1$center
pr1$scale
pr2=prcomp(d1) #开center
pr2$center
pr2$scale
pr3=prcomp(d1,scale=T)
pr2$scale
pr3$scale
mean(d1$sales)
std(d1$sales)
var(d1$sales)
stderr(d1$sales)
sqrt(var(d1$sales))
PC1.scale = rot[,1]
PC1.scale*2
PC1.scale*pr$scale+pr$center
PC1.scale+1
PC1.scale*pr$scale+pr$center
pr$center
as.matrix(scale(d1))%*%rot
pr = prcomp(d1,scale=T)
d0 = utilities
d0$X6 = as.numeric(d0$X6)
d1=d0[,-1]
pr = prcomp(d1,scale=T)
rot = pr$rotation
pr$x
as.matrix(scale(d1))%*%rot
PC1.scale = rot[,1]
as.matrix(scale(d1))%*%rot
PC1.scale = rot[,1]
PC1.scale
center = pr$center
stderr = pr$scale
std = pr$scale
center
std
getwd()
d0 = read.table("species")
d0 = read.table("species.txt")
d0
aux = as.numeric(d0$V1)
aux
plot(species~biomass,d0,col=aux,pch=aux,cex=0.88)
d1 = d0[-1,]
rownames(d1) = c("pH","Biomass","Species")
colnames(d1) = c("pH","Biomass","Species")
d1
aux = as.numeric(d1$pH)
plot(species~biomass,d1,col=aux,pch=aux,cex=0.88)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.88)
plot(Species~Biomass,d1)
library(PASWR2) #checking.plots
library(MASS)
d0 = Cars93
d1 = subset(d0,select=c("MPG.city","RPM","Weight"))
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
d0 = read.table("species.txt")
d1 = d0[-1,]
colnames(d1) = c("pH","Biomass","Species")
plot(Species~Biomass,d1,cex=0.6)
str(d0)
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
plot(Species~Biomass,d1,cex=0.6)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6)
plot(MPG.city~Weight,d3,col=aux,pch=aux,cex=0.88)
legend("topright",c("0","5700","5900","6500"),pch = aux,cex=0.6,col = aux)
aux = as.numeric(d1$pH)
aux
legend("topright",c("0","5700","5900","6500"),pch = aux,col = aux)
d1$pH
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = (1,3,2))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = (1,3,2))
legend("topright",c("high","mid","low"),pch = c(1,3,2))
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6)
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
legend("midright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
legend("bottom",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
str(d1)
library(PASWR2) #checking.plots
library(MASS)
d0 = Cars93
d1 = subset(d0,select=c("MPG.city","RPM","Weight"))
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
grid()
m0=lm(MPG.city~Weight,d1)
summary(m0)
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
text(MPG.city~Weight,d1,labels=rownames(d1),pos=1,cex=0.6)
abline(m0,lty=2)
grid()
checking.plots(m0)
d0[c(39,42,83),]
m1=lm(MPG.city~RPM+Weight,d0)
summary(m1)
anova(m1)
checking.plots(m1)
d2 = d0
d2$RPM = as.factor(d2$RPM)
m2=lm(MPG.city~RPM+Weight,d2)
summary(m2)
levels(d2$RPM)
levels(d2$RPM)[c(17,20,24)]
levels(d3$RPM)[-c(17,20,24)]="0"
d3$RPM
d3 = d2
d2$RPM
table(d2$RPM)
levels(d2$RPM)
levels(d2$RPM)[c(17,20,24)]
levels(d3$RPM)[-c(17,20,24)]="0"
d3$RPM
m3=lm(MPG.city~RPM+Weight,d3)
summary(m3)
library(MASS)
library(PASWR2)
d0 = Cars93
str(d0)
d1 = d0[-1,]
colnames(d1) = c("pH","Biomass","Species")
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
d0 = read.table("species.txt")
d1 = d0[-1,]
colnames(d1) = c("pH","Biomass","Species")
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
aux
d1$pH
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
str(d1)
m1 = glm(Species~Biomass*pH,d1,family = poisson)
m2 = glm(Species~.,d1,family = possion)
m2 = glm(Species~.,d1,family = poisson)
summary(m1)
summary(m2)
level(d1$pH)
levels(d1$pH)
str(d1)
anova(m1)
anova(m2)
summary(m2)
summary(m1)
summary(m1)
summary(m2)
anova(m1)
anova(m2)
anova(m1)
anova(m2)
summary(m1)
summary(m2)
yhat = predict(m1,d1,type="response")
yhat
library(PASWR2) #checking.plots
library(MASS)
d0 = Cars93
d1 = subset(d0,select=c("MPG.city","RPM","Weight"))
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
grid()
m0=lm(MPG.city~Weight,d1)
summary(m0)
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
text(MPG.city~Weight,d1,labels=rownames(d1),pos=1,cex=0.6)
abline(m0,lty=2)
grid()
checking.plots(m0)
d0[c(39,42,83),]
m1=lm(MPG.city~RPM+Weight,d0)
summary(m1)
anova(m1)
checking.plots(m1)
d2 = d0
d2$RPM = as.factor(d2$RPM)
m2=lm(MPG.city~RPM+Weight,d2)
summary(m2)
checking.plots(m2)
anova(m2)
d3 = d2
d2$RPM
table(d2$RPM)
levels(d2$RPM)
levels(d2$RPM)[c(17,20,24)]
levels(d3$RPM)[-c(17,20,24)]="0"
d3$RPM
m3=lm(MPG.city~RPM+Weight,d3)
summary(m3)
checking.plots(m3)
anova(m3)
par(mfrow=c(1,1)) #一页多图，一个图版显示1行1列
a = which(d3$RPM %in% c("5700","5900","6500"))
aux0=rownames(d3[d3$RPM!="0",])  # "5"  "32" "39" "42" "57"
aux0=as.numeric(aux0)
aux  = as.numeric(d3$RPM)
aux
plot(MPG.city~Weight,d3,col=aux,pch=aux,cex=0.88)
text(MPG.city~Weight,d3,labels=ifelse(d3$RPM!="0",rownames(d3),""),pos=1,offset=0.5,cex=1,col=aux)
text(MPG.city~Weight,d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
coef(m3)
abline(m3$coef[1],m3$coef[5],col=1,lty=1,lwd=1.4)
abline(m3$coef[1]+m3$coef[2],m3$coef[5],col=2,lty=2,lwd=1.4)
abline(m3$coef[1]+m3$coef[3],m3$coef[5],col=3,lty=3,lwd=1.4)
abline(m3$coef[1]+m3$coef[4],m3$coef[5],col=4,lty=4,lwd=1.4)
d0 = read.table("species.txt")
d1 = d0[-1,]
colnames(d1) = c("pH","Biomass","Species")
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
aux
d1$pH
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
m1 = glm(Species~Biomass*pH,d1,family = poisson)
m2 = glm(Species~.,d1,family = poisson)
anova(m1)
anova(m2)
summary(m1)
summary(m2)
yhat = predict(m1,d1,type="response")
summary(m1)
d2 = seq(0,100,0.1)
d2
summary(m1)
d3 = rep(0,1001)
d3 = rep(1,1001)
l2 = seq(0,100,0.1)
l3 = rep(1,1001)
d1
llow = rep("low",1001)
lmid = rep("mid",1001)
lhigh = rep("high",1001)
lbio = seq(0,100,0,1)
lbio = seq(0,100,0.1)
dlow = data.frame(pH = llow,Biomaa = lbio)
dlow
dlow = data.frame(pH = llow,Biomass = lbio)
dmid = data.frame(pH = lmid,Biomass = lbio)
d1
dhigh = data,frame(pH = lhigh,Biomass = lbio)
dhigh = data.frame(pH = lhigh,Biomass = lbio)
ylow = predict(m1,dlow,type="response")
ymid = predict(m1,dmid,type = "response")
yhigh = predict(m1,dhigh,type = "response")
abine(ylow)
abline(ylow)
abline(ylow~lbio)
plot(ylow~lbio)
line(ylow~lbio)
line
line
line
line(ylow~lbio)
curve(ylow~lbio)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
abline(3,2)
plot(ylow)
plot(ylow~lbio)
d1 = miller
llow = rep("low",101)
lmid = rep("mid",101)
lhigh = rep("high",101)
lbio = seq(0,100,1)
dlow = data.frame(pH = llow,Biomass = lbio)
dmid = data.frame(pH = lmid,Biomass = lbio)
dhigh = data.frame(pH = lhigh,Biomass = lbio)
ylow = predict(m1,dlow,type = "response")
ymid = predict(m1,dmid,type = "response")
yhigh = predict(m1,dhigh,type = "response")
plot(ylow~lbio)
llow = rep("low",1001)
lmid = rep("mid",1001)
lhigh = rep("high",1001)
lbio = seq(0,1000,1)
dlow = data.frame(pH = llow,Biomass = lbio)
dmid = data.frame(pH = lmid,Biomass = lbio)
dhigh = data.frame(pH = lhigh,Biomass = lbio)
ylow = predict(m1,dlow,type = "response")
ymid = predict(m1,dmid,type = "response")
yhigh = predict(m1,dhigh,type = "response")
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(ylow~lbio,pch = ".",add = T)
llow = rep("low",1001)
lmid = rep("mid",1001)
lhigh = rep("high",1001)
lbio = seq(0,100,0.1)
dlow = data.frame(pH = llow,Biomass = lbio)
dmid = data.frame(pH = lmid,Biomass = lbio)
dhigh = data.frame(pH = lhigh,Biomass = lbio)
ylow = predict(m1,dlow,type = "response")
ymid = predict(m1,dmid,type = "response")
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(ylow~lbio,pch = ".",add = T)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(ylow~lbio,pch = ".",add = T)
dlow2 = data.frame(Biomass = lbio,Species = ylow)
dlow2 = data.frame(Biomass = lbio,Species = ylow)
dmid2 = data.frame(Biomass = lbio,Species = ymid)
dhigh2 = data.frame(Biomass = lbio,Species = yhigh)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,dlow2)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,dlow2,add = T)
plot(Species~Biomass,d1,col=aux,pch=aux,cex=0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,dlow2,add = TRUE)
plot(Species~Biomass,dlow2,col= 1,pch= 1,cex = 0.6,xlim = c(0,100),ylim = c(0,40),add = TRUE)
plot(Species~Biomass,d1,col = aux,pch = aux,cex = 0.6,xlim = c(0,100),ylim = c(0,40))
plot(Species~Biomass,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40),add = TRUE)
plot(Species~Biomass,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40),add = TRUE)
plot(Species~Biomass,d1,col = aux,pch = aux,cex = 0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
plot(Species~Biomass,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40),add = TRUE)
plot(Species~Biomass,d1,col = aux,pch = aux,cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(Species~Biomass,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(Species~Biomass,dmid2,col= 3,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40)))
points(Species~Biomass,dmid2,col= 3,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(Species~Biomass,dhigh2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(Species~Biomass,dhigh2,col= 2,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
plot(Species~Biomass,d1,col = aux,pch = aux,cex = 0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
points(ylow~lbio,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(ymid~lbio,dmid2,col= 3,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(yhigh~lbio,dhigh2,col= 2,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
dp = data.frame(pH = "low",Biomass = 2.0)
predict(m1,dp,type = "response")
predict(m1,dp,type = "response",interval = "confident")
alpha <- 0.05
newval = data.frame(pH = "low",Biomass = 2.0)
alpha = 0.05
yhat = predict(m1, newval, se.fit=T, type="link")
lower95 = exp(yhat$fit - qnorm(1-alpha/2)*yhat$se.fit)
lower95 = round(lower95,3)
upper95 = exp(yhat$fit + qnorm(1-alpha/2)*yhat$se.fit)
upper95 = round(upper95,3)
cat("(", lower95,",",upper95,")\n")
cat("(",lower95,",",upper95,")\n")
cat("(",lower95,",",upper95,")")
cat("(",lower95,",",upper95,")\n")
d1
yhat = predict(m1,d1,type = "response")
yhat
res = yhat-d1$Species
which.max(abs(res))
res[85]
res[86]
which.max(abs(res))
res[85]
res[86]
res = yhat-d1$Species
res
yhat
d1
which.max(abs(res))
d1[85]
d1[85,]
rownames(d1) =c(1:90)
colnames(d1) = c("pH","Biomass","Species")
d1
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
aux
d1$pH
plot(Species~Biomass,d1,col = aux,pch = aux,cex = 0.6,xlim = c(0,100),ylim = c(0,40))
legend("topright",c("high","mid","low"),pch = c(1,3,2),col = c(1,3,2) )
m1 = glm(Species~Biomass*pH,d1,family = poisson)
m2 = glm(Species~.,d1,family = poisson)
anova(m1)
anova(m2)
summary(m1)
summary(m2)
summary(m1)
llow = rep("low",1001)
lmid = rep("mid",1001)
lhigh = rep("high",1001)
lbio = seq(0,100,0.1)
dlow = data.frame(pH = llow,Biomass = lbio)
dmid = data.frame(pH = lmid,Biomass = lbio)
dhigh = data.frame(pH = lhigh,Biomass = lbio)
ylow = predict(m1,dlow,type = "response")
ymid = predict(m1,dmid,type = "response")
yhigh = predict(m1,dhigh,type = "response")
points(ylow~lbio,dlow2,col= 1,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(ymid~lbio,dmid2,col= 3,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
points(yhigh~lbio,dhigh2,col= 2,pch=".",cex = 0.6,xlim = c(0,100),ylim = c(0,40))
d0 = read.table("species.txt")
d0
d1 = d0[-1,]
rownames(d1) =c(1:90)
colnames(d1) = c("pH","Biomass","Species")
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
aux
d1$pH
d0 = read.table("species.txt")
d0
colnames(d1) = c("pH","Biomass","Species")
d1$Biomass = as.numeric(d1$Biomass)
d1$Species = as.numeric(d1$Species)
aux = as.numeric(d1$pH)
aux
d1$pH
levels(d1$pH)
