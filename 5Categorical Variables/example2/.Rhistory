library(MASS)
d0 = Cars93
d1 = subset(d0,select=c("MPG.city","RPM","Weight"))
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
grid()
m0=lm(MPG.city~Weight,d1)
summary(m0)
plot(MPG.city~Weight,d1,pch=19,cex=0.6)
text(MPG.city~Weight,d1,labels=rownames(d1),pos=1,cex=0.6)
abline(m1,lty=2)
abline(m0,lty=2)
grid()
checking.plots(m0)
library(PASWR2) #checking.plots
checking.plots(m0)
d0[c(39,42,83),]
m1=lm(MPG.city~RPM+Weight,d0)
summary(m1)
anova(m1)
checking.plots(m1)
checking.plots(m0)
checking.plots(m1)
d2 = d0
d2$RPM = as.factor(d2$RPM)
m2=lm(MPG.city~RPM+Weight,d2)
summary(m2)
checking.plots(m2)
d2 = d0
d2$RPM = as.factor(d2$RPM)
m2=lm(MPG.city~RPM+Weight,d2)
summary(m2)
checking.plots(m2)
anova(m2)
d3 = d2
d2$RPM
levels(d2)
levels(d2$RPM)
levels(d2$RPM)[c(17,20,24)]
levels(d3$RPM)[-c(17,20,24)]="0"
d3$RPM
m3=lm(MPG.city~RPM+Weight,d3)
summary(m3)
checking.plots(m3)
anova(m3)
par(mfrow=c(1,1))
a = which(d3$RPM %in% c("5700","5900","6500"))
par(mfrow=c(1,1))
aux0=rownames(d3[d3$RPM!="0",])  # "5"  "32" "39" "42" "57"
aux0=as.numeric(aux0)
aux  = as.numeric(d3$RPM)
aus
aux
plot(MPG.city~Weight,d3,col=aux,pch=aux,cex=0.88)
text(MPG.city~Weight,d3,labels=ifelse(d3$RPM!="0",rownames(d3),""),pos=1,offset=0.5,cex=0.4,col=aux)
help(ifelse)
coef(m3)
abline(m3$coef[1],m3$coef[5],col=1,lty=1,lwd=1.4)
abline(m3$coef[1]+m3$coef[2],m3$coef[5],col=2,lty=2,lwd=1.4)
abline(m3$coef[1]+m3$coef[3],m3$coef[5],col=3,lty=3,lwd=1.4)
abline(m3$coef[1]+m3$coef[4],m3$coef[5],col=4,lty=4,lwd=1.4)
grid()
legend("topright",c("0","5700","5900","6500"),lty=1:4,cex=0.6,col=c(1,2,3,4))
coef(m0)
abline(47.04835,-0.008,col="purple")
lots(m3)
checking.plots(m3)
text(MPG,city~Weight,d3,labels=ifelse(rownames(d3)=83,rownames(d3),""))
text(MPG,city~Weight,d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
text(MPG.city~Weight,d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
text(d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
plot(MPG.city~Weight,d3,col=aux,pch=aux,cex=0.88)
text(d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
text(MPG.city~Weight,d3,labels=ifelse(rownames(d3)==83,rownames(d3),""))
text(MPG.city~Weight,d3,labels=ifelse(d3$RPM!="0",rownames(d3),""),pos=1,offset=0.5,cex=1,col=aux)
